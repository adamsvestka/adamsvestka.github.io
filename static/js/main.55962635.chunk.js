(this.webpackJsonphomepage=this.webpackJsonphomepage||[]).push([[0],{44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){},49:function(e,t,n){"use strict";n.r(t);var a=n(20),c=n(1),r=n(4),i=n.n(r),s=n(12),o=n.n(s),u=n(7),l=n(11),d=n.n(l),b=n(17),j=n(9),h=n(53),m=n(16),O=n(24),f=n.n(O),p=n(25),v=n(14),g=n(5),x=(n(21),n(50),n(40),n(51),n(44),Object(r.createContext)({})),_={Loading:function(){return Object(c.jsx)("div",{className:"loading-container",children:Object(c.jsx)("div",{className:"lds-ellipsis",children:Array.from(Array(4)).map((function(e,t){return Object(c.jsx)("div",{},t)}))})})},Switch:function(e){var t=e.on;return Object(c.jsx)("div",{className:"switch "+(t?"on":"off")})}};try{g.a.initializeApp({apiKey:"AIzaSyAzpjpeQgorGwi0JFEwHB4gmnoLCCaLY0k",authDomain:"homepage-407c5.firebaseapp.com",databaseURL:"https://homepage-407c5.firebaseio.com",projectId:"homepage-407c5",storageBucket:"homepage-407c5.appspot.com",messagingSenderId:"837019211462",appId:"1:837019211462:web:cf461d3ab5fa5bec6f69c7",measurementId:"G-2EHD20CHYQ"})}catch(J){console.error(J)}var I=n(6);n(45);function k(e){var t;return/https:\/\//.test(e.src)?Object(c.jsx)("img",Object(u.a)({alt:"",draggable:"false"},Object(u.a)(Object(u.a)({},e),{},{className:"msg-image"+(e.className?" "+e.className:"")}))):Object(c.jsx)("i",Object(u.a)(Object(u.a)({},Object(u.a)(Object(u.a)({},e),{},{className:"material-icons-round msg-image "+e.className})),{},{children:null!==(t=e.src)&&void 0!==t?t:"person"}))}function N(){var e=Object(r.useContext)(x),t=e.loading,n=e.user,a=e.banned,i=Object(r.useRef)(),s=Object(v.a)(g.a.database().ref("messages")),o=Object(j.a)(s,2),l=o[0],d=o[1],b=Object(v.b)(g.a.database().ref("users")),h=Object(j.a)(b,2),m=h[0],O=h[1];return Object(r.useEffect)((function(){return i.current&&(i.current.parentNode.scrollTop=i.current.offsetTop)})),Object(c.jsxs)("div",{className:"chat",children:[Object(c.jsx)("span",{className:"chat-header",children:I.chat_title}),Object(c.jsxs)("div",{className:"chat-body",children:[t||d||O?Object(c.jsx)(_.Loading,{}):a?Object(c.jsx)(y,{message:{text:I.chat_message_banned_text,displayName:I.chat_message_banned_user,photoURL:"verified_user"}}):null===l||void 0===l?void 0:l.map((function(e,t,a){var r,i,s=[];return(null===(r=a[t-1])||void 0===r?void 0:r.uid)===e.uid&&s.push("top"),(null===(i=a[t+1])||void 0===i?void 0:i.uid)===e.uid&&s.push("bottom"),Object(c.jsx)(y,{meta:{sent:e.uid===n.uid,connect:s},message:Object(u.a)(Object(u.a)({},e),m[e.uid])},t)})),Object(c.jsx)("div",{ref:i})]}),Object(c.jsx)(w,{})]})}function y(e){var t,n,a,r,i,s,o=e.meta,u=e.message;return Object(c.jsxs)("div",{className:"message "+((null===o||void 0===o?void 0:o.sent)?"sent":"received")+(null===o||void 0===o||null===(t=o.connect)||void 0===t||null===(n=t.map)||void 0===n||null===(a=n.call(t,(function(e){return" connect-"+e})))||void 0===a||null===(r=a.join)||void 0===r?void 0:r.call(a,"")),children:[!(null===o||void 0===o||null===(i=o.connect)||void 0===i?void 0:i.includes("top"))&&Object(c.jsx)(k,{src:null===u||void 0===u?void 0:u.photoURL,title:null!==(s=null===u||void 0===u?void 0:u.displayName)&&void 0!==s?s:I.chat_message_default_user}),Object(c.jsx)("span",{className:"msg-text",children:null===u||void 0===u?void 0:u.text})]})}function w(){var e,t,n,a=Object(r.useContext)(x).user,i=Object(r.useRef)(),s=function(e){e.key&&"Enter"!==e.key||/^\s*$/.test(i.current.value)||(g.a.database().ref("messages/").push({uid:a.uid,timestamp:g.a.database.ServerValue.TIMESTAMP,text:i.current.value}),i.current.value="")},o=null!==(e=null!==(t=null===a||void 0===a||null===(n=a.providerData)||void 0===n?void 0:n[0])&&void 0!==t?t:a)&&void 0!==e?e:{};return Object(c.jsxs)("div",{className:"chat-footer",children:[Object(c.jsx)(k,{src:o.photoURL,title:"You"}),Object(c.jsx)("input",{className:"chat-input",type:"text",placeholder:o.displayName?I.chat_input_placeholder_user.replace("{1}",o.displayName):I.chat_input_placeholder_default,onKeyDown:s,ref:i}),Object(c.jsx)("button",{className:"chat-send",onClick:s,children:I.chat_button_send})]})}function C(){return Object(c.jsx)("span",{children:I.chat_error_account})}var R=function(){var e=Object(r.useContext)(x),t=e.user;return e.loadingUser||t?Object(c.jsx)(N,{}):Object(c.jsx)(C,{})};n(46);function E(e){var t,n=e.name;return(null===n||void 0===n||null===(t=n.includes)||void 0===t?void 0:t.call(n,"https"))?Object(c.jsx)("img",{alt:"",draggable:"false",className:"user-image",src:n}):Object(c.jsx)("i",{className:"material-icons-round",children:n})}function S(e){var t,n,a,i,s=e.autoLogin,o=Object(r.useContext)(x),u=o.loading,l=o.user,h=o.banned,O=Object(r.useState)(null!==s&&void 0!==s&&s),p=Object(j.a)(O,2),v=p[0],k=p[1];if(u)return Object(c.jsx)(_.Loading,{});if(!l&&!v)return Object(c.jsx)(P,{leftIcon:"login",rightIcon:"keyboard_arrow_right",onClick:function(){return k(!0)},children:I.menubar_account_login});if(!l||v){var N={autoUpgradeAnonymousUsers:!0,callbacks:{signInSuccessWithAuthResult:function(e,t){k(!1)},signInFailure:function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("firebaseui/anonymous-upgrade-merge-conflict"===t.code){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return k(!1),g.a.auth().currentUser.delete(),e.next=6,g.a.auth().signInWithCredential(t.credential);case 6:return e.next=8,g.a.functions().httpsCallable("upgradeUser")({newUid:l.uid});case 8:return n=e.sent,console.log(n.data),e.abrupt("return");case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),signInSuccessUrl:!1},credentialHelper:m.auth.CredentialHelper.GOOGLE_YOLO,signInFlow:g.a.auth().isSignInWithEmailLink(window.location.href)?"redirect":"popup",signInOptions:[{provider:g.a.auth.EmailAuthProvider.PROVIDER_ID,signInMethod:g.a.auth.EmailAuthProvider.EMAIL_LINK_SIGN_IN_METHOD},{provider:g.a.auth.GoogleAuthProvider.PROVIDER_ID,clientId:"837019211462-a62qlmg12ln01fs4ubru65grnp86afup.apps.googleusercontent.com"},g.a.auth.FacebookAuthProvider.PROVIDER_ID,g.a.auth.TwitterAuthProvider.PROVIDER_ID,g.a.auth.GithubAuthProvider.PROVIDER_ID,g.a.auth.PhoneAuthProvider.PROVIDER_ID,!l&&m.auth.AnonymousAuthProvider.PROVIDER_ID]};return Object(c.jsx)(f.a,{uiConfig:N,firebaseAuth:g.a.auth()})}var y=null!==(t=null===(n=l.providerData)||void 0===n?void 0:n[0])&&void 0!==t?t:l;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(P,{leftIcon:null!==(a=y.photoURL)&&void 0!==a?a:"person",children:null!==(i=y.displayName)&&void 0!==i?i:"Anonymous"}),l.isAnonymous&&!h&&Object(c.jsx)(P,{leftIcon:"upgrade",onClick:function(){return k(!0)},children:I.menubar_account_upgrade}),y.email&&Object(c.jsx)(P,{leftIcon:"alternate_email",children:y.email}),y.phoneNumber&&Object(c.jsx)(P,{leftIcon:"phone",children:y.phoneNumber}),Object(c.jsx)(P,{leftIcon:"close",onClick:Object(b.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.auth().signOut();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),children:I.menubar_account_upgrade})]})}function L(e){var t=Object(r.useRef)();return Object(c.jsx)(h.a,{nodeRef:t,in:e.visible,timeout:200,classNames:"sidebar",children:Object(c.jsx)("aside",{ref:t,className:"sidebar",children:Object(c.jsx)("ul",{className:"sidebar-nav",children:e.children})})})}function A(e){return Object(c.jsxs)("div",{className:"clickable side-item",onClick:e.onClick,children:[e.leftIcon&&Object(c.jsx)("span",{className:"icon-button",children:Object(c.jsx)(E,{name:e.leftIcon})}),e.children,e.rightIcon&&Object(c.jsx)("span",{className:"icon-right",children:Object(c.jsx)(E,{name:e.rightIcon})})]})}var D=i.a.forwardRef((function(e,t){return Object(c.jsx)("div",Object(u.a)({className:"dropdown",ref:t},e))}));function P(e){return Object(c.jsxs)("div",{className:"clickable drop-item",onClick:e.onClick,children:[e.leftIcon&&Object(c.jsx)("span",{className:"icon-button",children:Object(c.jsx)(E,{name:e.leftIcon})}),e.children,e.rightIcon&&Object(c.jsx)("span",{className:"icon-right",children:Object(c.jsx)(E,{name:e.rightIcon})})]})}function U(e){return Object(c.jsx)("header",{className:"navbar",children:Object(c.jsx)("ul",{className:"navbar-nav",children:e.children})})}var M=function(){return Object(c.jsx)("li",{style:{margin:"auto"}})};function T(e){var t,n=Object(r.useState)(null!==(t=e.autoOpen)&&void 0!==t&&t),a=Object(j.a)(n,2),s=a[0],o=a[1],u=Object(r.useRef)(),l=Object(r.useRef)(),d=function(t){var n,a,c,r,i=t.target;return!e.persistent&&!(null===(n=u.current)||void 0===n||null===(a=n.contains)||void 0===a?void 0:a.call(n,i))&&!(null===(c=l.current)||void 0===c||null===(r=c.contains)||void 0===r?void 0:r.call(c,i))&&!i.className.includes("firebaseui")&&o(!1)};return Object(r.useEffect)((function(){return document.addEventListener("mousedown",d),function(){return document.removeEventListener("mousedown",d)}})),Object(c.jsxs)("li",{className:"nav-item"+(s?" open":""),ref:u,children:[Object(c.jsx)("div",{className:"clickable icon-button",onClick:function(){var t;o(!s),null===(t=e.onClick)||void 0===t||t.call(e,!s)},children:Object(c.jsx)(E,{name:e.icon})}),e.badge&&Object(c.jsx)("span",{className:"nav-badge",children:e.badge}),s&&e.children&&i.a.cloneElement(e.children,{ref:l})]})}function V(e){var t;return Object(c.jsx)("section",{className:"main",children:Object(c.jsx)("div",{className:"main-container",children:e.children[null!==(t=e.page)&&void 0!==t?t:0]})})}var Y=function(e){var t=e.keys,n=e.accessibility,a=Object(p.a)(g.a.auth()),i=Object(j.a)(a,2),s=i[0],o=i[1],l=Object(v.b)(g.a.database().ref("users/".concat(null===s||void 0===s?void 0:s.uid,"/strikes"))),h=Object(j.a)(l,2),m=h[0],O=h[1],f=O?null:m>2;console.log(f,m,"users/".concat(null===s||void 0===s?void 0:s.uid,"/strikes")),Object(r.useEffect)((function(){s&&!s.isAnonymous&&Object(b.a)(d.a.mark((function e(){var t,n,a,c,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=null!==(t=null===s||void 0===s||null===(n=s.providerData)||void 0===n?void 0:n[0])&&void 0!==t?t:s,c=g.a.storage().ref("users/"+s.uid+".jpg"),e.next=4,c.parent.listAll();case 4:if(!e.sent.items.map((function(e){return e.location.path})).includes("users/"+s.uid+".jpg")){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,fetch(a.photoURL);case 8:if((r=e.sent).ok){e.next=11;break}return e.abrupt("return");case 11:return e.t0=c,e.next=14,r.blob();case 14:return e.t1=e.sent,e.next=17,e.t0.put.call(e.t0,e.t1);case 17:return e.t2=g.a.database().ref("users/"+s.uid),e.t3=a.displayName,e.next=21,c.getDownloadURL();case 21:e.t4=e.sent,e.t5={displayName:e.t3,photoURL:e.t4},e.t2.set.call(e.t2,e.t5);case 24:case"end":return e.stop()}}),e)})))()}),[s]);var k=Object(r.useState)(Object(u.a)({sidebar:!1,location:0,accessibility:Object(u.a)({},Object.fromEntries(Object.values(t).map((function(e){return[e,null]}))))},JSON.parse(window.localStorage.getItem("state")))),N=Object(j.a)(k,2),y=N[0],w=N[1];Object(r.useEffect)((function(){var e=["location","accessibility"];window.localStorage.setItem("state",JSON.stringify(Object.fromEntries(Object.entries(y).filter((function(t){var n=Object(j.a)(t,1)[0];return e.includes(n)})))))}),[y]);var C=function(e){var t;return null!==(t=y.accessibility[e])&&void 0!==t?t:window.matchMedia(n[e][1]).matches},E=function(e,t){var a=Object(j.a)(n[e],2),c=a[0],r=a[1];switch(t){case window.matchMedia(r).matches:return c.mediaText=r,null;case!0:return c.mediaText="all",!0;default:return c.mediaText="not all",!1}},Y=function(e){var t=y;null===E(e,t.accessibility[e]=!C(e))&&(t.accessibility[e]=null),w(Object(u.a)({},t))};Object.keys(n).forEach((function(e){return E(e,C(e))}));var G=g.a.auth().isSignInWithEmailLink(window.location.href);return Object(c.jsxs)(x.Provider,{value:{loading:o||O,user:s,banned:f},children:[Object(c.jsxs)(L,{visible:y.sidebar,children:[Object(c.jsx)(A,{leftIcon:"airplanemode_on",onClick:function(){return w(Object(u.a)(Object(u.a)({},y),{},{location:0}))},children:I.sidebar_default}),Object(c.jsx)(A,{leftIcon:"airplanemode_on",onClick:function(){return w(Object(u.a)(Object(u.a)({},y),{},{location:1}))},children:I.sidebar_default}),Object(c.jsx)(A,{leftIcon:"chat",onClick:function(){return w(Object(u.a)(Object(u.a)({},y),{},{location:2}))},children:I.sidebar_chat})]}),Object(c.jsxs)(U,{children:[Object(c.jsx)(T,{icon:"menu",persistent:!0,onClick:function(e){return w(Object(u.a)(Object(u.a)({},y),{},{sidebar:e}))}}),Object(c.jsx)(M,{}),Object(c.jsx)(T,{icon:"notifications"+(m?"_active":""),badge:m,children:Object(c.jsx)(D,{children:(o||O)&&Object(c.jsx)(_.Loading,{})||f&&Object(c.jsx)(P,{leftIcon:"error",children:I.menubar_status_banned})||m&&Object(c.jsx)(P,{leftIcon:"warning",children:I.menubar_status_strikes.replace("{1}",m)})||Object(c.jsx)(P,{leftIcon:"thumb_up",children:I.menubar_status_ok})})}),Object(c.jsx)(T,{icon:"account_circle",persistent:!1,autoOpen:G,children:Object(c.jsx)(D,{children:Object(c.jsx)(S,{autoLogin:G})})}),Object(c.jsx)(T,{icon:"keyboard_arrow_down",children:Object(c.jsxs)(D,{children:[Object(c.jsx)(P,{leftIcon:"bedtime",onClick:function(){return Y("darkTheme")},rightIcon:Object(c.jsx)(_.Switch,{on:C("darkTheme")}),children:I.menubar_accessibility_theme}),Object(c.jsx)(P,{leftIcon:"double_arrow",onClick:function(){return Y("reducedMotion")},rightIcon:Object(c.jsx)(_.Switch,{on:C("reducedMotion")}),children:I.menubar_accessibility_motion})]})})]}),Object(c.jsxs)(V,{page:y.location,children:[Object(c.jsx)("span",{children:I.page1}),Object(c.jsx)("span",{children:I.page2}),Object(c.jsx)(R,{})]})]})},G={"(prefers-color-scheme: dark)":"darkTheme","(prefers-reduced-motion: reduce)":"reducedMotion"},H=Object.fromEntries(Object(a.a)(document.styleSheets).flatMap((function(e){return Object(a.a)(e.rules)})).filter((function(e){return e instanceof CSSMediaRule})).map((function(e){var t=e.media;return[G[t.mediaText],[t,t.mediaText.toString()]]})));o.a.render(Object(c.jsx)(i.a.StrictMode,{children:Object(c.jsx)(Y,{keys:G,accessibility:H})}),document.getElementById("root"))},6:function(e){e.exports=JSON.parse('{"page1":"Page 1","page2":"Page 2","sidebar_default":"Item","sidebar_chat":"Chat","menubar_accessibility_theme":"Dark Mode","menubar_accessibility_motion":"Reduced Motion","menubar_status_banned":"You have been banned!","menubar_status_strikes":"You have {1}/3 strikes!","menubar_status_ok":"Nothing to see here \ud83d\ude01","menubar_account_login":"Log In","menubar_account_upgrade":"Upgrade account","menubar_account_logout":"Sign out","chat_title":"Chatroom :)","chat_button_send":"Send","chat_input_placeholder_user":"Chatting as {1}...","chat_input_placeholder_default":"Chatting anonymously...","chat_error_account":"You must sign in first!","chat_message_default_user":"(anonymous)","chat_message_banned_text":"You have been banned noob!","chat_message_banned_user":"Admin"}')}},[[49,1,2]]]);
//# sourceMappingURL=main.55962635.chunk.js.map