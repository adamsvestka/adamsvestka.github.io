<html>
    <body>
        <script>
            window.onmessage = async ({ data: { pluginMessage: { url, payload } } }) => {
                const result = {};
                try {
                    const response = await fetch(url, payload);
                    for (const key of ['ok', 'status', 'statusText']) result[key] = response[key];
                    result.text = response.status != 204 ? await response.text() : null;
                } catch (error) {
                    result.ok = false;
                    result.error = error.message;
                }
                window.parent.postMessage({ pluginMessage: result }, '*');
            }
        </script>
    </body>
</html>
